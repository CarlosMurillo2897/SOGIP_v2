@using Microsoft.AspNet.Identity
@using App.Extensions

@{

    ViewBag.Title = "Usuarios Asignados";

    ViewBag.Referencia_Controlador_1 = "AtletasAsignados";
    ViewBag.Icono_Controlador_1 = "glyphicon-list-alt";
    ViewBag.Nombre_Controlador_1 = "Usuarios Asignados";

}

@Styles.Render("~/Content/manual.css")

<link href="~/Content/DataTables/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<link href="~/Content/DataTables/css/responsive.bootstrap4.min.css" rel="stylesheet" />

<div class="container">
    <div class="well">
        <input type="hidden" id="ced" value="@User.Identity.GetUserId()" />
        <h3>Usuarios Asignados</h3>
        <br />
        <input type="hidden" id="role" value="@ViewBag.Role" />
        <div class="table-responsive">
            <table id="example" class="table table-striped table-bordered dt-responsive nowrap">
                <thead>

                </thead>
            </table>
        </div>
    </div>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript" src="~/Scripts/DataTables/jquery.dataTables.min.js"></script>
    <script type="text/javascript" charset="utf8" src="~/Scripts/DataTables/dataTables.bootstrap4.min.js"></script>
    <script type="text/javascript" charset="utf8" src="~/Scripts/DataTables/dataTables.responsive.min.js"></script>
    <script type="text/javascript" charset="utf8" src="~/Scripts/DataTables/responsive.bootstrap4.min.js"></script>

    <script>
        $(document).ready(function () {
            var url = "";
            var ced = $('#ced').val();
            var col = [
                { data: "Cedula" },
                { data: "Nombre" },
                { data: "Apellido1" },
                { data: "Apellido2" }
            ];

            var head = '<tr><td>Cédula</td><td>Nombre</td><td>1° Apellido</td><td>2° Apellido</td><td>Acción</td></tr>';

            if ($('#role').val() == "Administrador") {
                url = "/SOGIP/AtletasAsignados/GetAtletasAdministrador";
            }
            else if ($('#role').val() == "Seleccion/Federacion") {
                url = "/SOGIP/AtletasAsignados/GetUsuariosSeleccion";
                head = '<tr><td>Cédula</td><td>Nombre</td><td>1° Apellido</td><td>2° Apellido</td><td>Rol</td><td>Categoría</td><td>Acción</td></tr>';
                col[col.length] = { data: "Rol" };
                col[col.length] = { data: "Categoria" };
            }
            else if ($('#role').val() == "Asociacion/Comite") {
                url = "/SOGIP/AtletasAsignados/GetAtletasAsociacion";
            }
            else if ($('#role').val() == "Entrenador") {
                
                url = "/SOGIP/AtletasAsignados/GetUsuariosEntrenador";
                head = '<tr><td>Cédula</td><td>Nombre</td><td>1° Apellido</td><td>2° Apellido</td><td>Categoría</td><td>Selección</td><td>Acción</td></tr>';
                col[col.length] = { data: "Categoria" };
                col[col.length] = { data: "Seleccion" };
            }

            col[col.length] = {
                data: "Id",
                "render": function (Id) {
                    return "<a class='btn btn-warning' href='/SOGIP/Account/Perfil?id=" + Id + "' style='padding: 2px 6px; margin:2px;'>" +
                        "<text class=''> Ver en detalle </text>" +
                        "<span class='glyphicon glyphicon-user'></span>" +
                        "</a>";
                }
            };

            $('#example thead').append(head);

            $('#example').DataTable({
                "language": {
                    "lengthMenu": "Mostrando _MENU_ resultados por página.",
                    "zeroRecords": "No se han encontrado registros.",
                    "info": "Mostrando página _PAGE_ de _PAGES_.",
                    "infoEmpty": "No hay datos para mostrar",
                    "infoFiltered": "(filtrado de _MAX_ datos obtenidos).",
                    "search": "Filtrar:",
                    "paginate": {
                        "first": "Primero",
                        "last": "Ultimo",
                        "next": "Siguiente",
                        "previous": "Anterior"
                    }
                },
                "ajax": {
                    "url": url,
                    "type": "GET",
                    "dataSrc": "",
                    "data": { usuarioId: ced }
                },
                columns: col
            });
        });
    </script>
}