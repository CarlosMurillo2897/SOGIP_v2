@model SOGIP_v2.Models.Maquina
@{
    ViewBag.Title = "EjerciciosMaquina";
    var viewDataMaquina = ViewData["maquina"];
    var viewDataNombre = ViewData["nombre"];
}
<link rel="stylesheet" type="text/css" href="~/Content/DataTables/css/jquery.dataTables.css">
<link rel="stylesheet" type="text/css" href="~/Content/DataTables/css/select.dataTables.min.css">

<div class="container">

</div>
<div class="well">
    <h4>Máquina</h4>
    <h4> @viewDataNombre </h4>
    <div class="table-responsive">
        <div id="tablaPrincipal"></div>
    </div>
    <div id="modal" class="modal fade">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title">
                        <text>Vídeo</text>
                    </h2>
                </div>

                <div class="modal-body" id="modalBody">
                    <div class="row">
                        <div class="col-md-12">

                            <style>
                                .video-container {
                                    position: center;
                                    padding-bottom: 50%;
                                    padding-top: 50px;
                                    height: 30%;
                                    overflow: hidden;
                                }

                                    .video-container iframe,
                                    .video-container object,
                                    .video-container embed {
                                        position: absolute;
                                        top: 0;
                                        left: 0;
                                        width: 100%;
                                        height: 100%;
                                    }
                            </style>
                            <div class="col-md-6">
                                <div class="video-container">
                                    <iframe width="853" height="480" frameborder="0" allowfullscreen id="one"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script type="text/javascript" charset="utf8" src="~/Scripts/DataTables/jquery.dataTables.js"></script>
    <script type="text/javascript" charset="utf8" src="~/Scripts/DataTables/dataTables.select.min.js"></script>
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        function tablaPrin() {
            var d = @viewDataMaquina;
            data ={
                id: d
            }
            $('#maquinas').DataTable().destroy();
            $('#maquinas').remove();
            $('#tablaPrincipal').show();
            var tabla = $('<table/>', { id: 'maquinas', class: 'table table-striped table-bordered dt-responsive nowrap', width: '100%' }).append('<thead><tr><th>Nombre</th><th>Acción</th></tr></thead>');
            $('#tablaPrincipal').append(tabla);
            table5 = $('#maquinas').DataTable({
                "language": {
                    "lengthMenu": "Mostrando _MENU_ resultados por página.",
                    "zeroRecords": "No se han encontrado registros.",
                    "info": "Mostrando página _PAGE_ de _PAGES_.",
                    "infoEmpty": "No hay datos para mostrar",
                    "infoFiltered": "(filtrado de _MAX_ datos obtenidos).",
                    "search": "Filtrar:",
                    "paginate": {
                        "first": "Primero",
                        "last": "Ultimo",
                        "next": "Siguiente",
                        "previous": "Anterior"
                    }
                },
                "ajax": {
                    "url": '/Maquina/getEjercicios',
                    "type": "GET",
                    "data": data,
                    "dataSrc": ""
                },
                columns: [
                    { data: "Nombre" },
                    {
                        data: "Id",

                        render: function (Id) {
                            return "<a class='btn btn-info' onclick='EnviarDes(" + Id + ")' style='padding: 2px 6px; margin: 2px;'>" +
                                "<text class='hidden-xs'>Ver </text>" +
                                "<span class='glyphicon glyphicon-sd-video'></span>" +
                                "</a>";
                        }
                    }
                ],
            });
        }
        function EnviarDes(id) {
            var tr = $('#boton_' + id).closest('tr');
            if (id === 0) {
                alert('Archivo predeterminado, no se puede ver video.');
                return;
            }

            $.ajax({
                type: "POST",
                url: "/Maquina/Descripcion",
                data: { id: id },
                success: function (data) {
                    $('#one').attr('src', data);
                    $('#modal').modal('show');

                },
                error: function (data) {
                    alert("¡Error!");
                }
            });
        }

        $(document).ready(function () {
            tablaPrin();

        });
    </script>
}
